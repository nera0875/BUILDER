#!/bin/bash
# Add metadata to existing template
# Run this manually with: sudo add-template-metadata

BUILT_DIR="/opt/builder/template-ready"

if [ "$EUID" -ne 0 ]; then
  echo "Error: This script requires sudo"
  echo "Usage: sudo add-template-metadata"
  exit 1
fi

if [ ! -d "$BUILT_DIR" ]; then
  echo "Error: Template directory not found: $BUILT_DIR"
  exit 1
fi

cat > "$BUILT_DIR/.built-at" << EOF
Built at: $(date -u +"%Y-%m-%d %H:%M:%S UTC")
Builder version: 2.2.0
Next.js version: $(node -p "require('$BUILT_DIR/package.json').dependencies.next" 2>/dev/null || echo "16.0.0")
Node version: $(node --version)
Script: add-template-metadata v1.0.0
Status: Metadata added to existing template
EOF

echo "âœ“ Metadata added to $BUILT_DIR/.built-at"
cat "$BUILT_DIR/.built-at"
